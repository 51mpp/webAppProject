@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}
@model (IEnumerable<CommentDeposit>,Deposit)
@if (Model.Item1 != null && Model.Item1.Any())
{
    <div class="row">
        <div class="order_box">
            <div class="card p-3 shadow-sm">
                <div class="d-flex justify-content-between align-items-center">
                    <div class="user d-flex flex-row align-items-center">
                        <div class="row">
                            <div class="col-3">
                                <small style="color: rgb(76, 158, 80);">@Model.Item1.FirstOrDefault().FirstName</small>
                            </div>
                            <div class="col-9">
                                <small class="font-weight-bold">@Model.Item1.FirstOrDefault().CommentText</small>
                            </div>
                            <div></div>
                            <div class="slip">
                                <img id="Image-@Model.Item1.FirstOrDefault().Id-comment" src="@Model.Item1.FirstOrDefault().Image" alt="">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        @if (Model.Item1.FirstOrDefault().Like == true)
        {
            <img class="w-25 h-25" src="https://cdn.discordapp.com/attachments/880751147449733150/1101569968333656125/pngwing.com.png" alt="">
        }
        @if (User.Identity.IsAuthenticated && (User.IsInRole("admin") || User.Identity.Name == Model.Item2.Email))
        {
            <button id="confirm-@Model.Item1.FirstOrDefault().Id-comments" onclick="confirmComment('@Model.Item1.FirstOrDefault().Id','@Model.Item1.FirstOrDefault().CommentText','@Model.Item1.FirstOrDefault().FirstName','@Model.Item1.FirstOrDefault().LastName','@Model.Item1.FirstOrDefault().Image','@Model.Item1.FirstOrDefault().Email','@Model.Item1.FirstOrDefault().Like','@Model.Item2.Id')">Confirm Comment</button>
        }
        @if (User.Identity.IsAuthenticated && (User.IsInRole("admin") || User.Identity.Name == Model.Item1.FirstOrDefault().Email))
        {
            <form asp-controller="Deposit" asp-action="DeleteComment" method="post">
                <input type="hidden" name="depositId" value="@Model.Item1.FirstOrDefault().Id" />
                <button type="submit" class="remove">
                    <img src="https://cdn-icons-png.flaticon.com/512/189/189690.png" alt="">
                </button>
            </form>
        }
    </div>
    <script>
        function confirmComment(commentDepositId, CommentText, FirstName, LastName, image, email, confirm, depositId) {
            $.ajax({
                url: '@Url.Action("ConfirmComment", "Deposit")',
                data: { commentDepositId: commentDepositId, CommentText: CommentText, FirstName: FirstName, LastName: LastName, image: image, email: email, confirm: confirm, depositId: depositId },
                type: 'POST',
                success: function (result) {
                    console.log(result);
                    // Do something with the result, if needed
                },
                error: function () {
                    console.log('Error occurred while confirming comment.');
                }
            });
        }
    </script>
}

